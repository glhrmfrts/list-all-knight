var app=angular.module("listAllKnight",[]);app.service("VideoService",["$http",function(t){var e=function(){this.url="https://www.googleapis.com/youtube/v3/playlistItems?part=snippet",this.params={key:"AIzaSyDmcfqSbjg3sjiW9rDC5KnXh1trtwrO23E",maxResults:1,playlistId:"PLiyjwVB09t5zm53TvttbxLE_YPrL8VkSm"}};return e.prototype.getNext=function(e){t.get(this.buildUrl()).success(this.onResult(e))},e.prototype.onResult=function(t){var e=this;return function(i){e.params.pageToken=i.nextPageToken,t(i.items.pop().snippet)}},e.prototype.buildUrl=function(){var t=this.url;for(var e in this.params)t+="&"+e+"="+this.params[e];return t},new e}]),app.filter("VideoDescriptionFilter",function(){return function(t){var e={appName:/^(.*)(\s)?(\((\$([0-9]*\.[0-9]+|[0-9]+)|FREE|[0-9]+\:[0-9]+)\))(\s)*$/i,appLink:/^(Android|iOS|WP8|Steam|Web)(\s)*(\((\$([0-9]*\.[0-9]+|[0-9]+)|FREE)\))?(\s)*(\:|-)(\s)*http(s)?\:\/{2}(.*)$/i},i=function(t){var e=t.indexOf(":"),i=t.indexOf("-"),n=t.indexOf("http");return e>=0&&n>e?e:i},n=function(t){return t.indexOf("itunes.apple")+t.indexOf("play.google")+t.indexOf("store.steam")+t.indexOf("goo.gl")>-4};return t.map(function(t){for(var o=t.description.split("\n"),r=[],s=0,p=0;p<o.length;p++){var l=o[p];if(e.appName.test(l))s=0,r.push({name:l,links:[],open:!1});else if(e.appLink.test(l)){var a=r.length-1,u=l.slice(0,i(l)),c=l.slice(i(l)+2);if(!n(c))continue;try{r[a].links.push({plat:u,href:c})}catch(f){console.log(f);continue}}else s=p}return t.title=t.title.slice(t.title.indexOf("App All Knight")),t.apps=r,t})}}),app.controller("ListController",["$scope","VideoService","$filter",function(t,e,i){t.videos=[],t.loading=!1,t.init=function(){t.getVideo()},t.getVideo=function(){t.loading=!0,e.getNext(function(e){t.videos.push(e),t.videos=i("VideoDescriptionFilter")(t.videos),t.loading=!1})},t.init()}]);